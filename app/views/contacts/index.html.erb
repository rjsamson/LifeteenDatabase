
<style type="text/css">
div#wrap{margin:0px auto;}
</style>

<h2>Listing Contacts</h2>
  <% if params[:s] and params[:s].length > 0 then %>
  <h4>Searching on: '<%=params[:s]%>'</h4>
  <% end %>
  <div id="wrap">
  <%= render 'sub' %>
  </div>


<script type="text/javascript">
var page = 0;
var s = "<%=params[:s]%>";
function yHandler(){
  // Watch video for line by line explanation of the code
  // http://www.youtube.com/watch?v=eziREnZPml4
  var wrap = document.getElementById("wrap");
  var contentHeight = wrap.offsetHeight;
  var yOffset = window.pageYOffset; 
  var y = yOffset + window.innerHeight;
  if(y >= contentHeight){
    page = page + 1;
    var url = "/sub_contacts?p="+page;
    if(s.length > 0) {
      url += "&s="+s;
    }
    //alert(url);
    // Ajax call to get more dynamic data goes here
    $.get(url, "", function(newhtml){
            document.getElementById("wrap").innerHTML += newhtml; 
            //alert($("#wrap").innerHTML);  
        });
  }
}
window.onscroll = yHandler;
</script>